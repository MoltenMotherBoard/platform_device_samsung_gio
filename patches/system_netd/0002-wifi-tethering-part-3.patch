From 2ef51885d334a80608e9ad2b8e4c90247e4263a1 Mon Sep 17 00:00:00 2001
From: Giovanni Santini <giovannisantini93@yahoo.it>
Date: Mon, 11 May 2015 22:14:37 +0200
Subject: [PATCH] Wifi Tethering [3/3]

Change-Id: I8be17eeba7ef2d739d472a6e111ed91d1b383041
---
 CommandListener.cpp  |   12 +++++++-----
 SoftapController.cpp |    7 ++++---
 2 files changed, 11 insertions(+), 8 deletions(-)

diff --git a/CommandListener.cpp b/CommandListener.cpp
index 047a417..bf4e83f 100644
--- a/CommandListener.cpp
+++ b/CommandListener.cpp
@@ -839,16 +839,18 @@ int CommandListener::SoftapCmd::runCommand(SocketClient *cli,
         return 0;
     }
 
-    if (!strcmp(argv[1], "start")) {
-        rc = sSoftapCtrl->startDriver(argv[2]);
-    } else if (!strcmp(argv[1], "stop")) {
-        rc = sSoftapCtrl->stopDriver(argv[2]);
-    } else if (!strcmp(argv[1], "startap")) {
+    if (!strcmp(argv[1], "startap")) {
         rc = sSoftapCtrl->startSoftap();
     } else if (!strcmp(argv[1], "stopap")) {
         rc = sSoftapCtrl->stopSoftap();
     } else if (!strcmp(argv[1], "fwreload")) {
         rc = sSoftapCtrl->fwReloadSoftap(argc, argv);
+#ifndef USES_TI_MAC80211
+    } else if (!strcmp(argv[1], "start")) {
+        rc = sSoftapCtrl->startDriver(argv[2]);
+    } else if (!strcmp(argv[1], "stop")) {
+        rc = sSoftapCtrl->stopDriver(argv[2]);
+#endif
     } else if (!strcmp(argv[1], "clients")) {
         rc = sSoftapCtrl->clientsSoftap(&retbuf);
         if (!rc) {
diff --git a/SoftapController.cpp b/SoftapController.cpp
index daee0b2..712fc87 100644
--- a/SoftapController.cpp
+++ b/SoftapController.cpp
@@ -7,7 +7,8 @@
  *
  *      http://www.apache.org/licenses/LICENSE-2.0
  *
- * Unless required by applicable law or agreed to in writing, software
+ * Unless required by applicable law
+  or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
@@ -171,8 +172,8 @@ bool SoftapController::isSoftapStarted() {
 
 /*
  * Arguments:
- *      argv[2] - wlan interface
- *      argv[3] - SSID
+ *  argv[2] - wlan interface
+ *  argv[3] - SSID
  *	argv[4] - Security
  *	argv[5] - Key
  *	argv[6] - Channel
-- 
1.7.9.5

