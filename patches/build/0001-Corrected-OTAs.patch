From f5f79055eb37ee33729f9cf4b789bc969351fb58 Mon Sep 17 00:00:00 2001
From: d33pcode <mpanunzio@hiddenhost.org>
Date: Tue, 24 Jun 2014 17:00:32 +0200
Subject: [PATCH] Corrected OTAs

---
 core/Makefile          | 4 ++--
 core/product_config.mk | 1 +
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/core/Makefile b/core/Makefile
index b7f92ee..a38e4f5 100644
--- a/core/Makefile
+++ b/core/Makefile
@@ -15,7 +15,7 @@ endif
 ifneq "" "$(filter eng.%,$(BUILD_NUMBER))"
   # BUILD_NUMBER has a timestamp in it, which means that
   # it will change every time.  Pick a stable value.
-  FILE_NAME_TAG := eng.$(USER)
+  FILE_NAME_TAG := $(TARGET_BUILD_VARIANT).$(USER)
 else
   FILE_NAME_TAG := $(BUILD_NUMBER)
 endif
@@ -1376,7 +1376,7 @@ bacon: otapackage
 ifeq ($(TARGET_CUSTOM_RELEASETOOL),)
 	$(hide) \
 	WANT_SQUASHFS=$(WANT_SQUASHFS) \
-	./vendor/cyanogen/tools/squisher
+	./vendor/mmb/mmb-squisher
 else
 	$(hide) \
 	WANT_SQUASHFS=$(WANT_SQUASHFS) \
diff --git a/core/product_config.mk b/core/product_config.mk
index fd8feb7..d15bd0d 100644
--- a/core/product_config.mk
+++ b/core/product_config.mk
@@ -186,6 +186,7 @@ ifneq ($(strip $(TARGET_BUILD_APPS)),)
   $(call import-products,$(call get-product-makefiles,\
       $(SRC_TARGET_DIR)/product/AndroidProducts.mk))
 else ifneq ($(CM_BUILD),)
+  # Breaks build if not present 'vendor/cyanogen/*'
   $(call import-products, vendor/cyanogen/products/cyanogen_$(CM_BUILD).mk)
 else
   # Read in all of the product definitions specified by the AndroidProducts.mk
-- 
2.3.0

